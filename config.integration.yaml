# InferaDB Management API Configuration - Integration Tests
# This config is optimized for Docker container E2E testing

frontend_base_url: "http://localhost:9090"

server:
  # Public REST API server
  host: "0.0.0.0" # Bind to all interfaces for Docker
  port: 9090

  # Public gRPC API server
  grpc_host: "0.0.0.0"
  grpc_port: 9091

  # Internal/Private REST API server
  internal_host: "0.0.0.0"
  internal_port: 9092

  worker_threads: 2 # Reduced for test environment

storage:
  backend: "memory" # In-memory for fast tests

auth:
  session_ttl_web: 3600 # 1 hour for tests
  session_ttl_cli: 7200 # 2 hours for tests
  session_ttl_sdk: 7200 # 2 hours for tests
  password_min_length: 8 # Relaxed for tests
  max_sessions_per_user: 5
  key_encryption_secret: "test-integration-secret-key-32bytes-long!"
  webauthn:
    rp_id: "localhost"
    rp_name: "InferaDB Test"
    origin: "http://localhost:9090"

email:
  smtp_host: "localhost"
  smtp_port: 1025
  from_email: "test@inferadb.local"
  from_name: "InferaDB Test"

rate_limiting:
  login_attempts_per_ip_per_hour: 1000 # Relaxed for tests
  registrations_per_ip_per_day: 100
  email_verification_tokens_per_hour: 100
  password_reset_tokens_per_hour: 100

observability:
  log_level: "debug" # Verbose logging for tests
  metrics_enabled: true
  tracing_enabled: false

id_generation:
  worker_id: 0

# Policy service (server) configuration for Kubernetes
# Discovery mode discovers all server pod IPs
policy_service:
  service_url: "http://inferadb-server.inferadb"
  grpc_port: 8081
  internal_port: 8082
  tls_enabled: false

identity:
  service_id: "management-integration-test"
  kid: "mgmt-test-2024"

cache_invalidation:
  timeout_ms: 5000
  retry_attempts: 0

# Kubernetes discovery for pod-level cache invalidation
discovery:
  mode:
    type: kubernetes
  cache_ttl_seconds: 30
